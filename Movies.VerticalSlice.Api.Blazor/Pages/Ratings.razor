@page "/ratings"
@using Telerik.Blazor.Components
@inject IHttpClientFactory HttpClientFactory
<TelerikGrid Data="@ratings" Height="400px" Pageable="true" Sortable="true">
    <GridColumns>
        <GridColumn Field="Id" Title="Id" />
        <GridColumn Field="MovieName" Title="MovieName" />
        <GridColumn Field="Rating" Title="Rating" />
        <GridColumn Field="DateUpdated" Title="DateUpdated" />
    </GridColumns>
</TelerikGrid>

@code {
    private List<MovieRatingWithNameDto> ratings = new();
    private HttpClient Http => HttpClientFactory.CreateClient("AuthorizedClient");

    protected override async Task OnInitializedAsync()
    {
        ratings = await Http.GetFromJsonAsync<List<MovieRatingWithNameDto>>("api/movies/ratings") 
            ?? new List<MovieRatingWithNameDto>();
    }


    public record MovieRatingWithNameDto(
        Guid Id,
        Guid MovieId,
        float Rating,
        string UserId,
        DateTime DateUpdated,
        string MovieName);
}